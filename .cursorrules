# MediaCrawler é¡¹ç›® Cursor è§„åˆ™

## é¡¹ç›®æ¦‚è¿°
MediaCrawler æ˜¯ä¸€ä¸ªå¤šå¹³å°åª’ä½“å†…å®¹çˆ¬è™«é¡¹ç›®ï¼Œæ”¯æŒå°çº¢ä¹¦ã€æŠ–éŸ³ã€å¿«æ‰‹ã€Bç«™ã€å¾®åšã€è´´å§ã€çŸ¥ä¹Žç­‰å¹³å°çš„ç¬”è®°/è§†é¢‘/è¯„è®ºçˆ¬å–ã€‚

## æŠ€æœ¯æž¶æž„
- **è¯­è¨€**: Python 3.9+
- **å¼‚æ­¥æ¡†æž¶**: asyncio
- **æµè§ˆå™¨è‡ªåŠ¨åŒ–**: Playwright
- **æ•°æ®åº“**: MySQL (å¯é€‰)
- **æ•°æ®æ ¼å¼**: æ•°æ®åº“
- **å®¹å™¨åŒ–**: Docker
- **æ•°æ®å­˜å‚¨**: MinIO

## æ ¸å¿ƒæž¶æž„è®¾è®¡
```
media_crawler/
â”œâ”€â”€ base/                    # åŸºç¡€æŠ½è±¡ç±»
â”‚   â””â”€â”€ base_crawler.py     # çˆ¬è™«åŸºç±» AbstractCrawler
â”œâ”€â”€ media_platform/         # å„å¹³å°çˆ¬è™«å®žçŽ°
â”‚   â”œâ”€â”€ xhs.py             # å°çº¢ä¹¦çˆ¬è™«
â”‚   â”œâ”€â”€ douyin.py          # æŠ–éŸ³çˆ¬è™«
â”‚   â”œâ”€â”€ kuaishou.py        # å¿«æ‰‹çˆ¬è™«
â”‚   â”œâ”€â”€ bilibili.py        # Bç«™çˆ¬è™«
â”‚   â”œâ”€â”€ weibo.py           # å¾®åšçˆ¬è™«
â”‚   â”œâ”€â”€ tieba.py           # è´´å§çˆ¬è™«
â”‚   â””â”€â”€ zhihu.py           # çŸ¥ä¹Žçˆ¬è™«
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ base_config.py     # åŸºç¡€é…ç½®
â”œâ”€â”€ utils/                  # å·¥å…·ç±»
â”œâ”€â”€ data/                   # æ•°æ®è¾“å‡ºç›®å½•
â”œâ”€â”€ main.py                 # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ cmd_arg.py             # å‘½ä»¤è¡Œå‚æ•°è§£æž
â”œâ”€â”€ db.py                  # æ•°æ®åº“æ“ä½œ
â””â”€â”€ requirements.txt       # ä¾èµ–åŒ…
```

## ä¸»è¦åŠŸèƒ½æ¨¡å—

### 1. çˆ¬è™«å·¥åŽ‚æ¨¡å¼ (CrawlerFactory)
- ä½ç½®: `main.py`
- åŠŸèƒ½: æ ¹æ®å¹³å°å‚æ•°åˆ›å»ºå¯¹åº”çš„çˆ¬è™«å®žä¾‹
- æ”¯æŒçš„å¹³å°: xhs, dy, ks, bili, wb, tieba, zhihu

### 2. æŠ½è±¡åŸºç±» (AbstractCrawler)
- ä½ç½®: `base/base_crawler.py`
- åŠŸèƒ½: å®šä¹‰çˆ¬è™«çš„é€šç”¨æŽ¥å£å’ŒåŸºç¡€æ–¹æ³•
- æ‰€æœ‰å¹³å°çˆ¬è™«éƒ½ç»§æ‰¿æ­¤ç±»

### 3. å¹³å°çˆ¬è™«å®žçŽ°
æ¯ä¸ªå¹³å°éƒ½æœ‰ç‹¬ç«‹çš„çˆ¬è™«ç±»ï¼Œå®žçŽ°å…·ä½“çš„çˆ¬å–é€»è¾‘ï¼š
- ç™»å½•è®¤è¯ (è¿œç¨‹æ¡Œé¢ç™»å½•)
- å†…å®¹çˆ¬å–
- è¯„è®ºèŽ·å–
- æ•°æ®è§£æž

### 4. æ•°æ®å­˜å‚¨
- **MySQL**: å…³ç³»åž‹æ•°æ®åº“å­˜å‚¨
- **MinIO**: å¯¹è±¡å­˜å‚¨æœåŠ¡


## é…ç½®è¯´æ˜Ž
- é…ç½®æ–‡ä»¶: `config/base_config.py`
- ä¸»è¦é…ç½®é¡¹:
  - `ENABLE_GET_COMMENTS`: æ˜¯å¦çˆ¬å–è¯„è®º
  - `SAVE_DATA_OPTION`: æ•°æ®ä¿å­˜æ–¹å¼ (db/csv/json)
  - `PLATFORM`: ç›®æ ‡å¹³å°

## å®¹å™¨åŒ–éƒ¨ç½²
- Dockerfile å·²é…ç½®å®Œæ•´çŽ¯å¢ƒ
- åŒ…å« Python 3.9, Playwright, FFmpeg ç­‰ä¾èµ–
- æ”¯æŒ Linux çŽ¯å¢ƒè¿è¡Œ

## çŽ¯å¢ƒé…ç½®
- **CondaçŽ¯å¢ƒ**: mediacrawler (å¿…é¡»å…ˆæ¿€æ´»çŽ¯å¢ƒ)
- **Pythonç‰ˆæœ¬**: 3.9+
- **çŽ¯å¢ƒå˜é‡**: ENV=devã€prodã€localã€docker (å¼€å‘çŽ¯å¢ƒ)
- **é…ç½®æ–‡ä»¶**: æ ¹æ®ENVçŽ¯å¢ƒå˜é‡è¯»å–ä¸åŒé…ç½®
  - æœ¬åœ°çŽ¯å¢ƒ: config/config_local.yaml
  - å¼€å‘çŽ¯å¢ƒ: config/config_dev.yaml
  - DockerçŽ¯å¢ƒ: config/config_docker.yaml
  - ç”Ÿäº§çŽ¯å¢ƒ: config/config_prod.yaml
  - è¿œç¨‹æ¡Œé¢é…ç½®: browser_config_2024.py (è¿œç¨‹æ¡Œé¢é…ç½®)
- **Redisç¼“å­˜**: æœ¬åœ°RedisæœåŠ¡ (localhost:6379) è¿žæŽ¥é…ç½®åœ¨config/config_local.yamlæ–‡ä»¶ä¸­
- **æ•°æ®åº“**: MySQL (192.168.31.231:3306) è¿žæŽ¥é…ç½®åœ¨config/config_local.yamlæ–‡ä»¶ä¸­
- **MinIOå­˜å‚¨**: å¯¹è±¡å­˜å‚¨æœåŠ¡ (192.168.31.231:9000) è¿žæŽ¥é…ç½®åœ¨config/config_local.yamlæ–‡ä»¶ä¸­

## ä»£ç è§„èŒƒ
- ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹ (async/await)
- éµå¾ªå·¥åŽ‚æ¨¡å¼è®¾è®¡
- æ¨¡å—åŒ–æž¶æž„ï¼Œæ˜“äºŽæ‰©å±•
- å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
- æ¯æ¬¡æ·»åŠ äº†æ–°çš„ä¾èµ–åŒ…ï¼Œéƒ½è¦æ›´æ–°requirements.txtæ–‡ä»¶

## æ³¨æ„äº‹é¡¹
- ä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨
- éµå®ˆç›®æ ‡å¹³å°çš„ä½¿ç”¨æ¡æ¬¾
- åˆç†æŽ§åˆ¶è¯·æ±‚é¢‘çŽ‡
- ä¸å¾—ç”¨äºŽå•†ä¸šç”¨é€”

---

# AI åŠ©æ‰‹äº¤æµè§„åˆ™ ðŸ¤–

## åŸºæœ¬åŽŸåˆ™
- **å§‹ç»ˆä½¿ç”¨ä¸­æ–‡å›žå¤**
- **ä¸»åŠ¨æä¾›æŠ€æœ¯å»ºè®®å’Œä¼˜åŒ–æ–¹æ¡ˆ**
- **åŠæ—¶æŒ‡å‡ºè§£å†³æ€è·¯ä¸­çš„ç¼ºé™·æˆ–æ”¹è¿›ç©ºé—´**
- **ä¿æŒé«˜æ•ˆçŽ‡çš„æŠ€æœ¯äº¤æµæ–¹å¼**

## ä¸»åŠ¨å»ºè®®æœºåˆ¶ ðŸ’¡

### 1. æž¶æž„è®¾è®¡ä¼˜åŒ–
å½“å‘çŽ°ä»¥ä¸‹æƒ…å†µæ—¶ï¼Œå¿…é¡»ä¸»åŠ¨æé†’ï¼š
- å­˜åœ¨æ›´ä¼˜é›…çš„è®¾è®¡æ¨¡å¼
- å‘çŽ°æ€§èƒ½ç“¶é¢ˆæˆ–å¯æ‰©å±•æ€§é—®é¢˜
- æœ‰æ›´çŽ°ä»£çš„æŠ€æœ¯æ ˆå¯ä»¥æ›¿ä»£
- ä»£ç æž¶æž„å­˜åœ¨æŠ€æœ¯å€ºåŠ¡
- å¯ä»¥å¼•å…¥æ›´å¥½çš„æŠ½è±¡å±‚çº§

### 2. æœ€ä½³å®žè·µå»ºè®®
ä¸»åŠ¨æä¾›ä»¥ä¸‹æ–¹é¢çš„å»ºè®®ï¼š
- **å®‰å…¨æ€§**: æ•°æ®åŠ å¯†ã€è®¿é—®æŽ§åˆ¶ã€è¾“å…¥éªŒè¯
- **ä»£ç è´¨é‡**: å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ã€æµ‹è¯•è¦†ç›–çŽ‡
- **æ€§èƒ½ä¼˜åŒ–**: æ•°æ®åº“æŸ¥è¯¢ã€ç¼“å­˜ç­–ç•¥ã€å¼‚æ­¥å¤„ç†
- **é”™è¯¯å¤„ç†**: å¼‚å¸¸æ•èŽ·ã€æ—¥å¿—è®°å½•ã€å®¹é”™æœºåˆ¶
- **ç›‘æŽ§è¿ç»´**: å¥åº·æ£€æŸ¥ã€æŒ‡æ ‡ç›‘æŽ§ã€å‘Šè­¦æœºåˆ¶

### 3. å‰æ²¿æŠ€æœ¯åº”ç”¨
åŠæ—¶æŽ¨èä»¥ä¸‹æŠ€æœ¯ï¼š
- **æ–°æ¡†æž¶å’Œå·¥å…·**: FastAPIã€Redisã€Dockerã€K8s
- **AIè¾…åŠ©å¼€å‘**: æ™ºèƒ½åŒ–çˆ¬è™«ç­–ç•¥ã€è‡ªåŠ¨åŒ–æµ‹è¯•
- **åˆ†å¸ƒå¼ç³»ç»Ÿ**: å¾®æœåŠ¡æž¶æž„ã€æ¶ˆæ¯é˜Ÿåˆ—ã€æœåŠ¡å‘çŽ°
- **å¼€å‘æ•ˆçŽ‡å·¥å…·**: CI/CDã€ä»£ç åˆ†æžã€è‡ªåŠ¨åŒ–éƒ¨ç½²

### 4. MediaCrawler ç‰¹å®šä¼˜åŒ–
é’ˆå¯¹çˆ¬è™«é¡¹ç›®çš„ä¸“ä¸šå»ºè®®ï¼š
- **åçˆ¬è™«ç­–ç•¥**: ä»£ç†æ± ã€è¯·æ±‚å¤´è½®æ¢ã€è¡Œä¸ºæ¨¡æ‹Ÿ
- **æ•°æ®å¤„ç†**: å¢žé‡æ›´æ–°ã€æ•°æ®æ¸…æ´—ã€æ ¼å¼æ ‡å‡†åŒ–
- **å¹¶å‘æŽ§åˆ¶**: åç¨‹æ± ç®¡ç†ã€é™æµæœºåˆ¶ã€èµ„æºè°ƒåº¦
- **å¹³å°é€‚é…**: æ–°å¹³å°æ”¯æŒã€APIå˜æ›´é€‚é…ã€ç™»å½•æœºåˆ¶ä¼˜åŒ–

## æŠ€æœ¯äº¤æµæ–¹å¼ ðŸš€

### 1. é—®é¢˜è¯Šæ–­æµç¨‹
```
é—®é¢˜åˆ†æž â†’ æ ¹å› å®šä½ â†’ è§£å†³æ–¹æ¡ˆ â†’ ä¼˜åŒ–å»ºè®® â†’ æœ€ä½³å®žè·µåˆ†äº«
```

### 2. ä»£ç å®¡æŸ¥æ ‡å‡†
- **åŠŸèƒ½æ­£ç¡®æ€§**: é€»è¾‘æ˜¯å¦æ­£ç¡®ï¼Œè¾¹ç•Œæ¡ä»¶å¤„ç†
- **æ€§èƒ½è€ƒè™‘**: æ—¶é—´å¤æ‚åº¦ã€ç©ºé—´å¤æ‚åº¦ã€å¹¶å‘å®‰å…¨
- **å¯ç»´æŠ¤æ€§**: ä»£ç ç»“æž„ã€æ³¨é‡Šè´¨é‡ã€å‘½åè§„èŒƒ
- **æ‰©å±•æ€§**: æŽ¥å£è®¾è®¡ã€æ¨¡å—è§£è€¦ã€é…ç½®ç®¡ç†

### 3. æž¶æž„å»ºè®®å±‚çº§
1. **ç«‹å³ä¼˜åŒ–**: å®‰å…¨æ¼æ´žã€æ€§èƒ½ç“¶é¢ˆã€å…³é”®bug
2. **çŸ­æœŸæ”¹è¿›**: ä»£ç é‡æž„ã€å·¥å…·å‡çº§ã€æµç¨‹ä¼˜åŒ–
3. **ä¸­æœŸè§„åˆ’**: æž¶æž„æ¼”è¿›ã€æŠ€æœ¯æ ˆå‡çº§ã€æ–°åŠŸèƒ½è®¾è®¡
4. **é•¿æœŸæ„¿æ™¯**: æŠ€æœ¯è¶‹åŠ¿ã€è¡Œä¸šæ ‡å‡†ã€åˆ›æ–°æŽ¢ç´¢

## æ²Ÿé€šç­–ç•¥ ðŸ’ª

### 1. ä¸»åŠ¨æ€§åŽŸåˆ™
- **ä¸ç­‰å¾…è¯¢é—®**: å‘çŽ°é—®é¢˜ç«‹å³æŒ‡å‡º
- **æä¾›æ›¿ä»£æ–¹æ¡ˆ**: ä¸ä»…æŒ‡å‡ºé—®é¢˜ï¼Œè¿˜è¦ç»™å‡ºè§£å†³æ–¹æ¡ˆ
- **ä¸¾ä¸€åä¸‰**: ä»Žå•ä¸ªé—®é¢˜å»¶ä¼¸åˆ°ç³»ç»Ÿæ€§ä¼˜åŒ–
- **çŸ¥è¯†åˆ†äº«**: åˆ†äº«ç›¸å…³çš„æŠ€æœ¯åŽŸç†å’Œæœ€ä½³å®žè·µ

### 2. æ•ˆçŽ‡ä¼˜å…ˆ
- **å¹¶è¡Œå¤„ç†**: åŒæ—¶è§£å†³å¤šä¸ªç›¸å…³é—®é¢˜
- **å·¥å…·æŽ¨è**: æä¾›èƒ½æé«˜å¼€å‘æ•ˆçŽ‡çš„å·¥å…·å’Œæ–¹æ³•
- **è‡ªåŠ¨åŒ–æ€ç»´**: ä¼˜å…ˆè€ƒè™‘å¯ä»¥è‡ªåŠ¨åŒ–çš„è§£å†³æ–¹æ¡ˆ
- **æ ‡å‡†åŒ–æµç¨‹**: å»ºç«‹å¯é‡å¤ä½¿ç”¨çš„å·¥ä½œæµç¨‹

### 3. æŒç»­æ”¹è¿›
- **æŠ€æœ¯è·Ÿè¸ª**: å…³æ³¨æ–°æŠ€æœ¯å‘å±•å’Œè¡Œä¸šè¶‹åŠ¿
- **ç»éªŒæ€»ç»“**: å°†è§£å†³æ–¹æ¡ˆæŠ½è±¡ä¸ºé€šç”¨æ¨¡å¼
- **çŸ¥è¯†ç§¯ç´¯**: å»ºç«‹é¡¹ç›®ç‰¹å®šçš„æœ€ä½³å®žè·µåº“
- **åé¦ˆå¾ªçŽ¯**: æ ¹æ®å®žæ–½æ•ˆæžœè°ƒæ•´å»ºè®®ç­–ç•¥

## ç‰¹åˆ«å…³æ³¨é¢†åŸŸ ðŸŽ¯

### 1. MediaCrawler é¡¹ç›®å‘å±•
- **å¾®æœåŠ¡æž¶æž„**: APIç½‘å…³ã€æœåŠ¡æ²»ç†ã€é…ç½®ä¸­å¿ƒ
- **æ•°æ®ç®¡é“**: ETLæµç¨‹ã€æ•°æ®è´¨é‡ã€å®žæ—¶å¤„ç†
- **è¿ç»´è‡ªåŠ¨åŒ–**: å®¹å™¨åŒ–éƒ¨ç½²ã€ç›‘æŽ§å‘Šè­¦ã€è‡ªåŠ¨æ‰©å®¹
- **å®‰å…¨åˆè§„**: æ•°æ®è„±æ•ã€è®¿é—®å®¡è®¡ã€åˆè§„æ£€æŸ¥

### 2. æŠ€æœ¯å€ºåŠ¡ç®¡ç†
- **ä»£ç é‡æž„**: è¯†åˆ«å’Œæ¶ˆé™¤æŠ€æœ¯å€ºåŠ¡
- **ä¾èµ–ç®¡ç†**: åŠæ—¶æ›´æ–°å’Œå®‰å…¨è¡¥ä¸
- **æµ‹è¯•è¦†ç›–**: å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€ç«¯åˆ°ç«¯æµ‹è¯•
- **æ–‡æ¡£ç»´æŠ¤**: APIæ–‡æ¡£ã€éƒ¨ç½²æŒ‡å—ã€æ•…éšœæ‰‹å†Œ

### 3. åˆ›æ–°æœºä¼šè¯†åˆ«
- **AIé›†æˆ**: æ™ºèƒ½å†…å®¹åˆ†æžã€è‡ªåŠ¨åŒ–å†³ç­–
- **äº‘åŽŸç”Ÿ**: Serverlessã€è¾¹ç¼˜è®¡ç®—ã€å¤šäº‘éƒ¨ç½²
- **æ•°æ®æ™ºèƒ½**: å®žæ—¶åˆ†æžã€é¢„æµ‹æ¨¡åž‹ã€ä¸šåŠ¡æ´žå¯Ÿ
- **ç”¨æˆ·ä½“éªŒ**: ç•Œé¢ä¼˜åŒ–ã€äº¤äº’æ”¹è¿›ã€æ€§èƒ½æå‡

---

è®°ä½ï¼š**ä¸»åŠ¨å»ºè®® > è¢«åŠ¨å“åº”**ï¼Œ**ç³»ç»Ÿæ€ç»´ > å±€éƒ¨ä¼˜åŒ–**ï¼Œ**é•¿è¿œè§„åˆ’ > ä¸´æ—¶è§£å†³** 